<link rel="stylesheet" href="{{url_for('static', filename='style.css')}}" />
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script>
	function del(food) {
		foodjson = {'foodelem':food}
        console.log(foodjson);
        var http = new XMLHttpRequest();
        http.open("POST", "/deletefood", true);
        http.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');
        http.send(JSON.stringify(foodjson));
	}
	
</script>
{% include "header.html" %}
<table style="width:90%">
	<tr>
		<th>Name</th>
		<th>Color</th>
		<th>Timestamp</th>
		<th>Delete</th>
	</tr>
	{% for foodelem in foodelems %}
	<tr>
	<td>{{foodelem.food_name}}</td>
	<td>{{foodelem.color}}</td>
	<td>{{foodelem.timestamp}}</td>
	<td>{{foodelem.uid}}</td>
	<td><a href="/deletefood/{{foodelem.eid}}">Delete</a></td>
	</tr>
	{% endfor %}
</table>
{% if foodelems != [] %}
{% set ns = namespace() %}
{% set ns.reds = 0 %}
{% set ns.yellows = 0 %}
{% set ns.greens = 0 %}
{% set ns.cals = 0 %}
{% set ns.pros = 0 %}
{% set ns.fats = 0 %}
{% set ns.carbs = 0 %}
{% set ns.redcals = 0 %}
{% set ns.yellowcals = 0 %}
{% set ns.greencals = 0 %}
{% for foodelem in foodelems %}
	{% if foodelem.color == "red" %}
		{% set ns.reds = ns.reds+foodelem.sid %}
		{% set ns.redcals = ns.redcals + foodelem.calories %}
	{% elif foodelem.color == "yellow" %}
		{% set ns.yellows = ns.yellows+foodelem.sid %}
		{% set ns.yellowcals = ns.yellowcals + foodelem.calories %}
	{% elif foodelem.color == "green" %}
		{% set ns.greens = ns.greens+foodelem.sid %}
		{% set ns.greencals = ns.greencals+foodelem.calories %}
	{% endif %}
	{% set ns.cals = ns.cals + foodelem.calories %}
	{% set ns.pros = ns.pros + foodelem.protein_amt %}
	{% set ns.fats = ns.fats + foodelem.fat_amt %}
	{% set ns.carbs = ns.carbs + foodelem.carb_amt %}
{% endfor %}
<h4>Servings</h4>
<p>Reds {{ns.reds}}</p>
<p>Yellows {{ns.yellows}}</p>
<p>Greens {{ns.greens}}</p>
<h4>Calories</h4>
<p>Reds {{ns.redcals}}</p>
<p>Yellows {{ns.yellowcals}}</p>
<p>Greens {{ns.greencals}}</p>
<h4>Total Stats</h4>
<p>Calories {{ns.cals}}</p>
<p>Proteins {{ns.pros}}</p>
<p>Fats {{ns.fats}}</p>
<p>Carbs {{ns.carbs}}</p>
{% macro piechart(r, y, g) -%}
	{% set sum = r+y+g %}
	{% set rs = r/sum %}
	{% set ys = y/sum %}
	{% set gs = g/sum %}
	
	<svg width="50" height="50">
		<path>M 25 25 V 0 </path>
	</svg>
{%- endmacro %}
{% endif %}
